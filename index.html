<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Roket Matematik</title>
    
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Roket Matematik">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(circle at center, #2b1055 0%, #7597de 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 10px;
            overflow: hidden;
            color: white;
        }

        /* --- TAM EKRAN FIRLATMA ALANI (Gƒ∞ZLƒ∞ KATMAN) --- */
        #launch-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #000000 0%, #2b1055 100%);
            z-index: 9999; /* Her ≈üeyin √ºst√ºnde */
            display: none; /* Ba≈ülangƒ±√ßta gizli */
            flex-direction: column;
            align-items: center;
            justify-content: flex-end; /* Roket alttan ba≈ülar */
            overflow: hidden;
        }

        #big-rocket {
            font-size: 150px;
            filter: drop-shadow(0 0 20px orange);
            position: absolute;
            bottom: -200px; /* Ekranƒ±n altƒ±nda ba≈üla */
            left: 50%;
            transform: translateX(-50%);
        }

        /* Fƒ±rlatma Animasyonu */
        .fly-up {
            animation: flyUpAnimation 3s ease-in-out forwards;
        }

        @keyframes flyUpAnimation {
            0% { bottom: 10px; transform: translateX(-50%) scale(1); }
            20% { bottom: 10px; transform: translateX(-50%) scale(1) rotate(-2deg); } /* Titreme */
            30% { bottom: 10px; transform: translateX(-50%) scale(1) rotate(2deg); }
            100% { bottom: 120%; transform: translateX(-50%) scale(0.8); } /* Ekran dƒ±≈üƒ±na √ßƒ±k */
        }

        /* --- OYUN ƒ∞√áƒ∞ K√ú√á√úK PANEL --- */
        #space-container {
            width: 100%;
            max-width: 500px;
            height: 140px; /* Y√ºksekliƒüi biraz azalttƒ±k */
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            margin-bottom: 10px;
            overflow: hidden;
            border: 2px solid rgba(255,255,255,0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Hareket eden yƒ±ldƒ±zlar */
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: twinkle 2s infinite;
        }
        @keyframes twinkle { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }

        #small-rocket {
            font-size: 60px;
            filter: drop-shadow(0 0 10px orange);
            transition: transform 0.3s;
            margin-bottom: 5px;
        }

        #fuel-wrapper {
            width: 80%;
            margin-top: 10px;
        }
        
        #fuel-label {
            font-size: 12px;
            text-align: center;
            margin-bottom: 2px;
            font-weight: bold;
            text-shadow: 0 1px 2px black;
        }

        #fuel-tank {
            width: 100%;
            height: 12px;
            background: #333;
            border-radius: 10px;
            border: 2px solid #fff;
            overflow: hidden;
        }

        #fuel-level {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ff4e50, #f9d423);
            transition: width 0.4s ease-out;
        }

        #planet-display {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 40px;
            opacity: 0.8;
        }

        /* --- OYUN ALANI --- */
        #game-wrapper {
            width: 100%;
            max-width: 500px;
            display: flex; /* Animasyonda gizlemek i√ßin flex yapƒ±da tutuyoruz */
            flex-direction: column;
            align-items: center;
        }

        #game-container {
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 10px;
            position: relative;
            z-index: 10;
        }

        /* SKOR TABLOSU */
        #score-board {
            background: #f1f2f6;
            border-radius: 15px;
            padding: 5px 15px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            align-self: center;
            border: 2px solid #dfe4ea;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 5px;
        }

        .score-item { font-size: 1.1rem; font-weight: bold; display: flex; align-items: center; gap: 5px; }
        .score-correct { color: #2ecc71; }
        .score-wrong { color: #ff4757; }
        .score-divider { color: #ccc; font-size: 1.2rem; }

        #level-indicator {
            font-size: 1rem;
            color: #444;
            font-weight: bold;
            background: #ffeb3b;
            padding: 5px 15px;
            border-radius: 15px;
            display: inline-block;
            align-self: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        #question {
            font-size: 3.5rem;
            font-weight: bold;
            color: #2b1055;
            background: #eef2f3;
            padding: 5px;
            border-radius: 15px;
            border: 3px solid #ccc;
        }

        .options-container {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .option {
            flex: 1;
            padding: 10px 5px;
            border: 3px solid #ccc;
            border-radius: 15px;
            background: white;
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
        }
        .option:active { transform: scale(0.95); background: #f0f0f0; }

        .icon { font-size: 30px; display: block; margin-bottom: 5px; }
        .count { font-size: 24px; font-weight: bold; color: #333; }

        /* --- GERƒ∞ Bƒ∞LDƒ∞Rƒ∞M YAZISI (D√úZELTƒ∞LDƒ∞) --- */
        #feedback { 
            height: 30px; 
            font-size: 1.2rem; /* Punto k√º√ß√ºlt√ºld√º */
            font-weight: bold; 
            color: #2b1055; 
            margin-top: 5px;
            white-space: nowrap; /* Satƒ±r kaymasƒ±nƒ± engelle */
            overflow: visible;
        }

        /* --- SEVƒ∞YE BUTONLARI --- */
        #level-selector {
            width: 100%;
            max-width: 500px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 6px;
            margin-top: 15px;
            position: relative;
            z-index: 5;
        }

        .level-btn {
            padding: 8px 0;
            width: 40px;
            font-size: 0.9rem;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            background: rgba(255,255,255,0.2);
            color: white;
            cursor: pointer;
        }
        .level-btn.active {
            background: #ffeb3b;
            color: #2b1055;
            transform: scale(1.1);
            box-shadow: 0 0 10px #ffeb3b;
        }
        
        @media (max-height: 700px) {
            #question { font-size: 2.8rem; }
            #small-rocket { font-size: 50px; }
            #space-container { height: 120px; }
        }
    </style>
</head>
<body>

    <div id="launch-overlay">
        <div id="stars-overlay"></div>
        <div style="color:white; margin-top:50px; font-size: 1.2rem; font-weight:bold; text-align:center;">
            HARƒ∞KA! YENƒ∞ GEZEGENE Gƒ∞Dƒ∞YORUZ!
        </div>
        <div id="big-rocket">üöÄ</div>
    </div>

    <div id="game-wrapper">
        <div id="space-container">
            <div id="stars-bg"></div>
            <div id="planet-display">üåç</div>
            <div id="small-rocket">üöÄ</div>
            
            <div id="fuel-wrapper">
                <div id="fuel-label">YAKIT DURUMU</div>
                <div id="fuel-tank">
                    <div id="fuel-level"></div>
                </div>
            </div>
        </div>

        <div id="game-container">
            <div id="score-board">
                <span class="score-item score-correct">
                    ‚úî <span id="correct-val">0</span>
                </span>
                <span class="score-divider">|</span>
                <span class="score-item score-wrong">
                    ‚úñ <span id="wrong-val">0</span>
                </span>
            </div>

            <div id="level-indicator">Seviye: 2'ler</div>
            <div id="question">? x ?</div>
            
            <div class="options-container">
                <div id="left-option" class="option" onclick="checkAnswer('left')">
                    <span id="left-icon" class="icon">üçé</span>
                    <span id="left-count" class="count">?</span>
                </div>
                <div id="right-option" class="option" onclick="checkAnswer('right')">
                    <span id="right-icon" class="icon">üçé</span>
                    <span id="right-count" class="count">?</span>
                </div>
            </div>
            <div id="feedback"></div>
        </div>
    </div>

    <div id="level-selector"></div>

    <script>
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        function playTone(freq, type, duration) {
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            osc.connect(gain); gain.connect(audioContext.destination);
            osc.frequency.value = freq; osc.type = type;
            gain.gain.setValueAtTime(0.1, audioContext.currentTime);
            gain.gain.linearRampToValueAtTime(0.01, audioContext.currentTime + duration);
            osc.start(audioContext.currentTime); osc.stop(audioContext.currentTime + duration);
        }

        function playLaunchSound() {
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            osc.connect(gain); gain.connect(audioContext.destination);
            // G√ºr√ºlt√ºl√º bir kalkƒ±≈ü sesi sim√ºlasyonu
            osc.frequency.setValueAtTime(80, audioContext.currentTime);
            osc.frequency.linearRampToValueAtTime(300, audioContext.currentTime + 3);
            osc.type = 'sawtooth';
            
            gain.gain.setValueAtTime(0.3, audioContext.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 3);
            
            osc.start(audioContext.currentTime); osc.stop(audioContext.currentTime + 3);
        }

        let currentLevel = 2;
        let correctAnswer;
        
        // --- SKOR VE YAKIT ---
        let totalCorrect = 0;
        let totalWrong = 0;
        let currentFuel = 0;
        const maxFuel = 10; // 10 doƒüru cevapta bir fƒ±rlatma

        const fruits = ['üçé', 'üçå', 'üçá', 'üçì', 'üçí', 'üçç', 'üçä', 'üçâ', 'üçê', 'ü•≠'];
        const planets = ['üåë', 'ü™ê', 'üåç', 'üåû', 'üåù', '‚≠ê', '‚òÑÔ∏è', 'üõ∏', 'üåå', 'ü™ê'];
        
        // Yƒ±ldƒ±zlarƒ± olu≈ütur (Hem k√º√ß√ºk panele hem tam ekrana)
        function createStars(elementId) {
            const bg = document.getElementById(elementId);
            for(let i=0; i<40; i++) {
                let s = document.createElement('div');
                s.className = 'star';
                s.style.left = Math.random() * 100 + '%';
                s.style.top = Math.random() * 100 + '%';
                s.style.width = Math.random() * 3 + 'px';
                s.style.height = s.style.width;
                s.style.animationDuration = (Math.random() * 2 + 1) + 's';
                bg.appendChild(s);
            }
        }
        createStars('stars-bg');
        createStars('launch-overlay');

        function updateFuel() {
            currentFuel++;
            let percent = (currentFuel / maxFuel) * 100;
            document.getElementById('fuel-level').style.width = percent + '%';
            
            if (currentFuel >= maxFuel) {
                startFullScreenLaunch();
            }
        }

        function startFullScreenLaunch() {
            // 1. Ekranlarƒ± deƒüi≈ütir
            document.getElementById('game-wrapper').style.display = 'none';
            document.getElementById('level-selector').style.display = 'none';
            document.getElementById('launch-overlay').style.display = 'flex';
            
            // 2. Roket Animasyonunu Ba≈ülat
            const bigRocket = document.getElementById('big-rocket');
            bigRocket.classList.remove('fly-up');
            void bigRocket.offsetWidth; // Reset animation trigger
            bigRocket.classList.add('fly-up');
            
            playLaunchSound();

            // 3. Animasyon bitince (3 saniye sonra)
            setTimeout(() => {
                // G√∂r√ºn√ºm√º geri al
                document.getElementById('launch-overlay').style.display = 'none';
                document.getElementById('game-wrapper').style.display = 'flex';
                document.getElementById('level-selector').style.display = 'flex';
                
                // Deƒüerleri Sƒ±fƒ±rla
                currentFuel = 0;
                document.getElementById('fuel-level').style.width = '0%';
                
                // Yeni Gezegen
                const randomPlanet = planets[Math.floor(Math.random() * planets.length)];
                document.getElementById('planet-display').innerText = randomPlanet;
                
                // Mesaj
                document.getElementById('feedback').innerText = "Yeni Gezegene ƒ∞ndik! üö©";
                document.getElementById('feedback').style.color = "#2ecc71";
                
                setTimeout(generateQuestion, 1500);

            }, 3000);
        }

        const levels = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 'karƒ±≈üƒ±k'];

        function getLevelTitle(level) {
            if (level === 'karƒ±≈üƒ±k') return 'Karƒ±≈üƒ±k';
            const larSuffixNumbers = [6, 9, 10]; 
            return larSuffixNumbers.includes(level) ? level + "'lar" : level + "'ler";
        }

        function initLevelButtons() {
            const selector = document.getElementById('level-selector');
            levels.forEach(level => {
                const btn = document.createElement('button');
                btn.className = `level-btn ${level === currentLevel ? 'active' : ''}`;
                btn.id = `btn-${level}`;
                btn.innerText = level === 'karƒ±≈üƒ±k' ? 'üé≤' : level;
                btn.onclick = () => changeLevel(level);
                selector.appendChild(btn);
            });
        }

        function changeLevel(level) {
            currentLevel = level;
            document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${level}`).classList.add('active');
            
            const title = getLevelTitle(level);
            document.getElementById('level-indicator').innerText = `Seviye: ${title}`;
            generateQuestion();
        }

        function generateQuestion() {
            if(currentFuel >= maxFuel) return; 

            document.getElementById('feedback').innerText = '';
            let num1, num2;
            if (currentLevel === 'karƒ±≈üƒ±k') {
                num1 = Math.floor(Math.random() * 10) + 1;
                num2 = Math.floor(Math.random() * 10) + 1;
            } else {
                num1 = currentLevel;
                num2 = Math.floor(Math.random() * 10) + 1;
            }
            correctAnswer = num1 * num2;
            let wrongAnswer = correctAnswer + (Math.random() > 0.5 ? num1 : -num1);
            if (wrongAnswer <= 0) wrongAnswer = correctAnswer + num1;
            if (wrongAnswer === correctAnswer) wrongAnswer = correctAnswer + 1;

            document.getElementById('question').innerText = `${num1} √ó ${num2}`;
            const isLeftCorrect = Math.random() > 0.5;
            document.getElementById('left-count').innerText = isLeftCorrect ? correctAnswer : wrongAnswer;
            document.getElementById('right-count').innerText = isLeftCorrect ? wrongAnswer : correctAnswer;
            
            const fruit = fruits[Math.floor(Math.random() * fruits.length)];
            document.getElementById('left-icon').innerText = fruit;
            document.getElementById('right-icon').innerText = fruit;
            
            window.correctSide = isLeftCorrect ? 'left' : 'right';
        }

        function checkAnswer(side) {
            if(currentFuel >= maxFuel) return; 

            if (side === window.correctSide) {
                document.getElementById('feedback').innerText = 'Harika! ‚úÖ';
                document.getElementById('feedback').style.color = "#2b1055";
                playTone(600, 'sine', 0.1); 
                
                // Skor g√ºncelle
                totalCorrect++;
                document.getElementById('correct-val').innerText = totalCorrect;
                
                // Yakƒ±t g√ºncelle (Bu fonksiyon i√ßinde 10 olunca fƒ±rlatma ba≈ülar)
                updateFuel();
                
                if (currentFuel < maxFuel) {
                    setTimeout(generateQuestion, 800);
                }
            } else {
                document.getElementById('feedback').innerText = 'Tekrar Dene ‚ùå';
                document.getElementById('feedback').style.color = "#ff4757";
                playTone(150, 'sawtooth', 0.3);
                
                totalWrong++;
                document.getElementById('wrong-val').innerText = totalWrong;
            }
        }

        initLevelButtons();
        changeLevel(2);
    </script>
</body>
</html>

